<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EkoYatra â€” EkoStories</title>
  <style>
    :root{
      --bg:#f6fff6;
      --card:#ffffff;
      --accent:#4ec07a;
      --accent-2:#a3ec83;
      --muted:#556963;
      --dark:#063;
      --radius:14px;
      --shadow-sm:0 4px 12px rgba(10,60,30,0.05);
      --shadow-md:0 8px 24px rgba(10,60,30,0.08);
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:Inter, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background:linear-gradient(180deg,#f9fff9 0%, #ffffff 100%);
      color:var(--dark);
      -webkit-font-smoothing:antialiased;
      line-height:1.55;
    }

    /* header */
    header{
      position:sticky;top:0;z-index:1000;
      background: rgba(255,255,255,0.9);
      padding:12px 18px;backdrop-filter: blur(10px);
      box-shadow: var(--shadow-sm);
      display:flex;align-items:center;justify-content:space-between;
    }
    .brand{
      font-weight:800;font-size:1.2rem;color:var(--accent);
      display:flex;gap:8px;align-items:center;letter-spacing:-0.5px;
    }
    .nav-links{display:flex;gap:14px}
    .nav-links a{
      color:var(--muted);
      padding:.5rem .8rem;border-radius:10px;
      font-weight:500;text-decoration:none;transition:.25s;
    }
    .nav-links a.active,
    .nav-links a:hover{
      background:linear-gradient(90deg, rgba(78,192,122,0.14), rgba(163,236,131,0.1));
      color:var(--dark);
    }

    /* main layout */
    main.container{max-width:1120px;margin:24px auto;padding:16px}
    .top-row{display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap}
    h1{font-size:1.8rem;font-weight:700;letter-spacing:-0.3px}
    .muted{color:var(--muted)}

    /* two-column */
    .layout{display:grid;grid-template-columns:1fr 340px;gap:20px;margin-top:20px}
    @media(max-width:920px){.layout{grid-template-columns:1fr}}

    /* cards feed */
    .stories-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}
    .story-card{
      background:var(--card);border-radius:var(--radius);overflow:hidden;
      box-shadow:var(--shadow-md);cursor:pointer;transition:.25s;
      opacity:0;transform:translateY(20px);
      animation:fadeUp .6s forwards;
    }
    .story-card:hover{transform:translateY(-6px) scale(1.02)}
    .story-card img{width:100%;height:160px;object-fit:cover;display:block}
    .story-card .meta{padding:14px}
    .story-card h3{margin:0 0 6px 0;font-size:1.05rem}
    .story-card p{margin:0;color:var(--muted);font-size:.92rem;line-height:1.4}

    /* overlay */
    .story-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:2000;animation:fadeIn .3s ease}
    .story-frame{
      width:min(780px,95%);height:min(92vh,740px);
      background:#000;border-radius:var(--radius);overflow:hidden;
      position:relative;display:flex;flex-direction:column;box-shadow:0 10px 32px rgba(0,0,0,0.45);
    }
    .story-image{flex:1;background:#111 center/cover no-repeat;display:flex;align-items:flex-end;padding:18px;color:white;transition:.3s}
    .story-text{background:linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.65));padding:14px;border-top-left-radius:8px;border-top-right-radius:8px}
    .story-controls{position:absolute;top:12px;left:12px;display:flex;gap:10px}
    .ctrl-btn{background:rgba(255,255,255,0.15);border:none;color:white;padding:8px 10px;border-radius:12px;cursor:pointer;transition:.25s;font-size:1rem}
    .ctrl-btn:hover{background:rgba(255,255,255,0.3)}
    .progress-strip{position:absolute;top:0;left:0;height:4px;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}

    /* sidebar */
    .sidebar{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow-md)}
    .sidebar h3{margin-top:0;margin-bottom:10px;font-size:1.2rem}
    .form-group{margin-bottom:12px}
    input[type="text"], textarea{
      width:100%;padding:11px 12px;border-radius:10px;
      border:1px solid rgba(0,0,0,0.08);font-size:0.95rem;
      transition:border .2s, box-shadow .2s;
    }
    input[type="text"]:focus, textarea:focus{
      outline:none;border-color:var(--accent);box-shadow:0 0 0 2px rgba(78,192,122,0.2);
    }
    button.btn{
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      border:none;color:#053;padding:10px 14px;border-radius:12px;
      cursor:pointer;font-weight:700;font-size:.95rem;transition:.25s;
      box-shadow:0 3px 10px rgba(78,192,122,0.25);
    }
    button.btn:hover{transform:translateY(-2px)}
    .small{font-size:0.88rem;color:var(--muted)}

    /* footer */
    footer{
      max-width:1120px;margin:28px auto 18px auto;padding:14px;
      color:var(--muted);text-align:center;font-size:.9rem;
      border-top:1px solid rgba(0,0,0,0.06);
    }

    /* animations */
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes fadeUp{to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>
  <header>
    <div class="brand">ðŸ“– EkoStories</div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <!-- <a href="index.html#menu">Menu</a> -->
      <a href="ekostories.html" class="active">Stories</a>
      <a href="./help.html">Contact</a>
    </nav>
  </header>

  <main class="container">
    <div class="top-row">
      <h1>Inspiring Eko Stories</h1>
      <div class="small muted">Swipe through stories or open in full story mode</div>
    </div>

    <div class="layout">
      <!-- left: stories feed -->
      <section>
        <div class="stories-grid" id="storiesGrid"></div>
        <div style="margin-top:12px;text-align:center">
          <button id="openFirst" class="btn">Open First Story</button>
        </div>
      </section>

      <!-- right: submit form & recent -->
      <aside class="sidebar">
        <h3>Share Your Story</h3>
        <div class="form-group">
          <input id="titleInput" type="text" placeholder="Story title" />
        </div>
        <div class="form-group">
          <textarea id="descInput" rows="4" placeholder="Short description / what happened"></textarea>
        </div>
        <div class="form-group">
          <input id="imgInput" type="text" placeholder="Image URL (optional)" />
          <div class="small muted">Tip: paste an image URL or leave blank for placeholder</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="submitStory" class="btn">Submit Story</button>
          <button id="clearStories" class="btn" style="background:#eee;color:var(--dark);box-shadow:none">Clear</button>
        </div>

        <h4 style="margin-top:12px">Recent Stories</h4>
        <div id="recentList" class="small muted"></div>
      </aside>
    </div>
  </main>

  <!-- Story overlay -->
  <div id="storyOverlay" class="story-overlay" aria-hidden="true">
    <div class="story-frame" role="dialog" aria-modal="true">
      <div class="progress-strip" id="progressStrip"></div>
      <div class="story-image" id="storyImage">
        <div class="story-controls">
          <button class="ctrl-btn" id="prevBtn">â—€</button>
          <button class="ctrl-btn" id="nextBtn">â–¶</button>
          <button class="ctrl-btn" id="closeBtn">âœ•</button>
        </div>
        <div style="width:100%"></div>
        <div class="story-text" id="storyText">
          <h3 id="storyTitle" style="margin:0"></h3>
          <p id="storyDesc" style="margin:6px 0 0 0;color:rgba(255,255,255,0.95)"></p>
        </div>
      </div>
    </div>
  </div>

  <footer>Share to inspire â€” EkoStories demo (saved locally).</footer>

  <script>
    // --- EkoStories JS (no backend) ---
    const STORAGE_KEY = 'ekoyatra_stories_v1';

    const starter = [
      {
        id: 's1',
        title: 'Village Planting Drive',
        desc: 'We planted 200 trees along the riverbank â€” kids, elders & volunteers came together!',
        img: "https://www.infoans.org/media/k2/items/cache/83ae357fec8eba398717da5e96b247b3_L.jpg",
        date: Date.now() - 1000*60*60*24*3
      },
      {
        id: 's2',
        title: 'Community Compost',
        desc: 'Neighborhood started a weekly compost corner. Food scraps now become garden gold.',
        img: 'https://images.unsplash.com/photo-1587733761376-3f26fc81d17f?w=500&auto=format&fit=crop&q=60',
        date: Date.now() - 1000*60*60*8
      },
      {
        id: 's3',
        title: 'Solar Lamp Workshop',
        desc: 'We taught 30 students how to build low-cost solar lamps â€” learning + light!',
        img: "",
        date: Date.now() - 1000*60*60*30
      }
    ];

    let stories = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
    if(!stories){ stories = starter; save(); }

    const storiesGrid = document.getElementById('storiesGrid');
    const recentList = document.getElementById('recentList');

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(stories)); }

    function renderGrid(){
      storiesGrid.innerHTML = '';
      stories.forEach((s, idx)=>{
        const card = document.createElement('div'); card.className='story-card';
        card.style.animationDelay = (idx*0.1) + "s";
        card.innerHTML = `
          <img src="${s.img || placeholder()}" alt="${escape(s.title)}" />
          <div class="meta">
            <h3>${escape(s.title)}</h3>
            <p>${escape(s.desc).slice(0,120)}${s.desc.length>120? '...' : ''}</p>
          </div>
        `;
        card.onclick = ()=> openStory(idx);
        storiesGrid.appendChild(card);
      });
      renderRecent();
    }

    function renderRecent(){
      recentList.innerHTML = stories.slice(-4).reverse().map(s=>`${escape(s.title)} <span style="color:var(--muted)">â€¢ ${timeAgo(s.date)}</span>`).join('<br>');
    }

    document.getElementById('submitStory').addEventListener('click', ()=>{
      const t = document.getElementById('titleInput').value.trim();
      const d = document.getElementById('descInput').value.trim();
      const i = document.getElementById('imgInput').value.trim();
      if(!t || !d) return alert('Please add a title and description.');
      const newStory = { id: 's_' + Math.random().toString(36).slice(2,9), title:t, desc:d, img:i || placeholder(), date: Date.now() };
      stories.push(newStory); save(); renderGrid();
      document.getElementById('titleInput').value=''; document.getElementById('descInput').value=''; document.getElementById('imgInput').value='';
      alert('Story saved locally! It appears in the feed.');
    });

    document.getElementById('clearStories').addEventListener('click', ()=>{
      if(!confirm('Clear all stories (including samples)?')) return;
      stories = []; save(); renderGrid();
    });

    function placeholder(){
      return 'https://images.unsplash.com/photo-1501004318641-b39e6451bec6?q=80&w=1200&auto=format&fit=crop';
    }

    // overlay logic
    const overlay = document.getElementById('storyOverlay');
    const storyImage = document.getElementById('storyImage');
    const storyTitle = document.getElementById('storyTitle');
    const storyDesc = document.getElementById('storyDesc');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeBtn = document.getElementById('closeBtn');
    const progressStrip = document.getElementById('progressStrip');
    let activeIndex = 0;
    let progressTimer = null;

    function openStory(idx){
      activeIndex = idx;
      showActiveStory();
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden', 'false');
      startAutoplay();
    }
    function closeStory(){
      overlay.style.display = 'none';
      overlay.setAttribute('aria-hidden', 'true');
      stopAutoplay();
    }
    function showActiveStory(){
      const s = stories[activeIndex];
      if(!s) return;
      storyImage.style.backgroundImage = `url('${s.img || placeholder()}')`;
      storyTitle.textContent = s.title;
      storyDesc.textContent = s.desc;
      resetProgress();
    }
    prevBtn.addEventListener('click', ()=>{
      activeIndex = (activeIndex - 1 + stories.length) % stories.length;
      showActiveStory();
    });
    nextBtn.addEventListener('click', ()=>{
      activeIndex = (activeIndex + 1) % stories.length;
      showActiveStory();
    });
    closeBtn.addEventListener('click', closeStory);

    function startAutoplay(){
      stopAutoplay();
      let elapsed = 0;
      const total = 6000;
      progressStrip.style.width = '0%';
      progressTimer = setInterval(()=>{
        elapsed += 200;
        const pct = Math.min(100, (elapsed/total)*100);
        progressStrip.style.width = pct + '%';
        if(elapsed >= total){
          nextBtn.click();
          elapsed = 0;
          progressStrip.style.width = '0%';
        }
      },200);
    }
    function stopAutoplay(){
      if(progressTimer) clearInterval(progressTimer);
      progressStrip.style.width = '0%';
    }
    function resetProgress(){ stopAutoplay(); startAutoplay(); }

    // swipe for mobile
    let touchStartX = 0;
    storyImage.addEventListener('touchstart', (e)=>{ touchStartX = e.touches[0].clientX; });
    storyImage.addEventListener('touchend', (e)=>{
      const dx = e.changedTouches[0].clientX - touchStartX;
      if(dx > 50) prevBtn.click();
      else if(dx < -50) nextBtn.click();
    });

    function escape(s){ return String(s||'').replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]); }
    function timeAgo(ts){
      if(!ts) return '';
      const diff = Math.floor((Date.now() - ts)/1000);
      if(diff < 60) return `${diff}s`;
      if(diff < 3600) return `${Math.floor(diff/60)}m`;
      if(diff < 86400) return `${Math.floor(diff/3600)}h`;
      return `${Math.floor(diff/86400)}d`;
    }

    document.getElementById('openFirst').addEventListener('click', ()=> openStory(0));
    renderGrid();
    overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeStory(); });
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeStory(); });
  </script>
</body>
</html>

